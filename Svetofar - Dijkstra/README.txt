http://judge.openfmi.net:9280/practice/get_problem_description?contest_id=52&problem_id=153

Закъснение
Иво както винаги закъснявал за среща, за това си взел мекицата със сирене и чантата и излетял от
вкъщи. Качил се в колата и отворил Мугъл Мапс©, за да избере най-бързият път до дестинацията
си, но ей на! Прословутите карти не работили.
Тука е момента да вметнем, колко уникален продукт е всъщност Мугъл Мапс©. Картите измерват
бързината с която можете да минете по даден път, чрез статистика направена от многото клиенти.
Така отчитат и фактори като задръстванията за този период на деня, а също така и колко секунди
свети червено и зелено на различните светофари (жълтото считат че не съществува). Картите
предоставят уникална навигация, намираща най-бързият път между точка Щ и Ь.
Иво вече закъснявал и нещата щели да бъдат много зле, ако не била уникалната му фотографска
памет. Слава богу той имал всичките терабайти от информация запаметени в главата. Погледнал
календара, замислил се накратко и започнал да чертае картата на града върху бял лист. Докато
чертаел, той внимателно си спомнял по кой път колко време ще му отнеме, за да премине през
задръстванията, а също така и означавал на всяко кръстовище продължителността на светене на
различните светлини.
До тук всичко било добре, но той осъзнал, че ще му отнемат близо 5 години, докато изчисли най-
късият възможен маршрут от първото кръстовище до кръстовището на дестинацията. Вие, като
добри хора (и програмисти, които имат само 5 часа, за да си решат контролното по ДАА),
помогнете на Иво, като напишете програма на любим за вас език (тоест С++), която ние ще му
изпратим веднага след края на изпита! Така Иво няма да закъснее повече от 10 часа за срещата си
и всичко ще е в реда на нещата.
Вход
На първия ред ще седят числата N и М. Където:
- N e броят на кръстовищата в града. Държим да отбележим, че за ваше удобство кръстовището
от което тръгва Иво е номерирано с 1, а кръстовището на дестинацията е номерирано с N.
- М е броят на улиците.
Следват М реда, като на всеки са зададени две кръстовища и времето в секунди, необходимо за
придвижване от едното кръстовище до другото.
Следват N реда, на i-ят от които са зададени времетраенето на зеленото и червеното на светофара
на i-тото кръстовище. Имайте в предвид че:
- Моментът на смяна н светофара от един цвят в друг е допустим за преминаване.
- Ако когато Иво пристигне на кръстовище с номер N, неговият светофар свети червено, колата
трябва да изчака момента на светване на зеленото, за да се смята за пристигнала.
- Иво ще уцели така момента си на тръгване, че всички светофари ще светят зелено тогава. Изход
На един ред на стандартния изход програмата трябва да се изведе минималното време, в секунди,
необходимо за достигане от кръстовището на Иво (кръстовище 1) до кръстовището на
дестинацията (кръстовище N).
Oграничения
2 < N ? 5000
Пример
Вход
1
7 11
1 2 12
1 4 9
1 6 6
2 6 7
2 3 15
3 6 8
3 5 2
3 7 4
4 5 15
4 6 4
5 6 10
7 4
5 11
2 8
4 5
8 8
0 120
2 5
35